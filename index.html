<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Biblioteca de Treinamentos - Up Business</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
        /* Adicionado para ajustar o scroll */
        .scroll-target {
            position: relative;
            top: 560px; /* Ajuste fino da posição */
        }
    </style>
    <script>
        document.getElementById('data-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
        const newData = document.getElementById('json-input').value;
    
        // Envia para um serviço externo
        const response = await fetch('https://api.jsonbin.io/v3/b/SEU-BIN-ID', {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': 'SUA-CHAVE'
      },
        body: newData
    });

        alert('Dados atualizados com sucesso!');
  });
        async function atualizarJson() {
            const response = await fetch('/.netlify/functions/updateGitHubJson', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    // Envie o conteúdo do JSON atualizado aqui
                    clientes: {
                        grupoduzani: {
                            nome: "Novo Nome",
                            cor: "#FF5733",
                            logo: "nova_imagem.png",
                            modulos: [
                                { "nome": "Vendas", "videos": ["Video 1", "Video 2"] }
                            ]
                        }
                    }
                }),
            });

            const result = await response.json();
            if (response.status === 200) {
                alert('Arquivo JSON atualizado com sucesso!');
            } else {
                alert('Falha ao atualizar o arquivo JSON');
            }
        }

        // Função ajustada para rolar até o ponto correto
        function rolarParaLogin() {
            const target = document.getElementById('scrollTarget');
            if (target) {
                const headerHeight = document.querySelector('.alura-header').offsetHeight;
                const targetPosition = target.offsetTop - headerHeight - 30; // Ajuste fino
                
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <button class="update-button" onclick="atualizarJson()">Atualizar JSON</button>
    </div>
    
    <!-- Header Alura Style -->
    <header class="alura-header">
        <div class="header-container">
            <div class="header-left">
                <div class="logo">
                    <img id="logoHeader" src="images-removebg-preview.png" alt="Logo Up Business">
                    <span class="logo-text"></span>
                </div>
            </div>
            
            <div class="header-center">
                <div class="search-container" id="headerSearch" style="display: none;">
                    <input type="text" placeholder="O que você quer aprender?" id="globalSearch">
                    <button class="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            
            <div class="header-right">
                <button class="theme-toggle" onclick="alternarTema()">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="header-btn" id="loginBtn" onclick="rolarParaLogin()">
                    <i class="fas fa-sign-in-alt"></i>
                    Entrar
                </button>
                <button class="header-btn primary" id="userBtn" onclick="mostrarPerfil()" style="display: none;">
                    <i class="fas fa-user"></i>
                    <span id="userName"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs (Alura Style) -->
    <nav class="alura-nav" id="mainNav" style="display: none;">
        <div class="nav-container">
            <div class="nav-tabs">
                <button class="nav-tab active" data-category="todos">
                    <i class="fas fa-th-large"></i>
                    Todos os Cursos
                </button>
                <button class="nav-tab" data-category="vendas">
                    <i class="fas fa-chart-line"></i>
                    Vendas
                </button>
                <button class="nav-tab" data-category="cadastros">
                    <i class="fas fa-database"></i>
                    Cadastros
                </button>
                <button class="nav-tab" data-category="financeiro">
                    <i class="fas fa-dollar-sign"></i>
                    Financeiro
                </button>
                <button class="nav-tab" data-category="operacoes">
                    <i class="fas fa-cogs"></i>
                    Operações
                </button>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <!-- Ponto de destino para o scroll (adicionado) -->
        <div id="scrollTarget" class="scroll-target"></div>
        
        <!-- Tela de Login Alura Style -->
        <div id="loginArea" class="login-area">
            <div class="login-hero">
                <div class="hero-content">
                    <h1>Domine o <span class="highlight">ERP Upbusiness</span> com Excelência!</h1>
                    <p>Transforme sua equipe em especialistas no sistema ERP mais completo do mercado. Nossa biblioteca de treinamentos oferece capacitação completa em todas as funcionalidades do Upbusiness, desde cadastros básicos até relatórios avançados.</p>
                </div>
                <div class="hero-visual">
                    <div class="floating-elements">
                        <div class="floating-card">
                            <i class="fas fa-play"></i>
                        </div>
                        <div class="floating-card">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="floating-card">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="login-section">
                <div class="login-card">
                    <div class="login-header">
                        <h2>Acesse sua Biblioteca</h2>
                        <p>Entre com suas credenciais para começar</p>
                    </div>

                    <!-- Toggle Switch para Usuário/Admin -->
                    <div class="access-toggle">
                        <div class="toggle-container">
                            <label class="toggle-switch">
                                <input type="checkbox" id="accessToggle" onchange="alternarTipoAcesso()">
                                <span class="toggle-slider"></span>
                            </label>
                            <div class="toggle-labels">
                                <span id="clienteText" class="toggle-label active">Cliente</span>
                                <span id="adminText" class="toggle-label">Admin</span>
                            </div>
                        </div>
                    </div>

                    <!-- Formulário de Usuário -->
                    <div id="userForm" class="login-form active">
                        <div class="form-group">
                            <label for="domainInput">Domínio da Empresa</label>
                            <div class="input-wrapper">
                                <i class="fas fa-building"></i>
                                <input type="text" id="domainInput" placeholder="ex: upbusiness" oninput="formatarDominio(this)">
                            </div>
                        </div>
                        <button class="btn-primary" onclick="validarDominio()">
                            <i class="fas fa-sign-in-alt"></i>
                            Acessar Biblioteca
                        </button>
                        <div class="error-message" id="errorMsg">
                            <i class="fas fa-exclamation-triangle"></i>
                            Domínio não encontrado!
                        </div>
                    </div>

                    <!-- Formulário HTML -->
                    <form id="data-form">
                        <textarea id="json-input" placeholder='{"novo": "dado"}'></textarea>
                        <button type="submit">Atualizar</button>
                    </form>

                    <!-- Formulário de Administrador -->
                    <div id="adminForm" class="login-form">
                        <div class="form-group">
                            <label for="adminUser">Login</label>
                            <div class="input-wrapper">
                                <i class="fas fa-user"></i>
                                <input type="text" id="adminUser" placeholder="Digite seu login">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="adminPass">Senha</label>
                            <div class="input-wrapper">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="adminPass" placeholder="Digite sua senha">
                            </div>
                        </div>
                        <button class="btn-primary admin" onclick="validarAdmin()">
                            <i class="fas fa-sign-in-alt"></i>
                            Entrar como Admin
                        </button>
                        <div class="error-message" id="adminErrorMsg">
                            <i class="fas fa-exclamation-triangle"></i>
                            Credenciais incorretas!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Área de Vídeos (Usuário) - Estilo Alura -->
        <div id="videoArea" class="video-area" style="display:none;">
            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <button class="breadcrumb-btn" onclick="voltarInicio()">
                    <i class="fas fa-arrow-left"></i>
                    Voltar ao Início
                </button>
                <div class="breadcrumb-path">
                    <span>Biblioteca</span>
                    <i class="fas fa-chevron-right"></i>
                    <span id="currentModule">Todos os Cursos</span>
                </div>
            </div>

            <!-- Main Content -->
            <div class="video-layout">
                <!-- Sidebar com Lista de Vídeos -->
                <aside class="video-sidebar">
                    <div class="sidebar-header">
                        <h3>Cursos Disponíveis</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchInput" placeholder="Buscar curso..." oninput="filtrarVideos()">
                        </div>
                    </div>
                    
                    <div class="course-list" id="videoList">
                        <!-- Cursos serão carregados aqui -->
                    </div>
                </aside>

                <!-- Player Principal -->
                <main class="video-main">
                    <div class="video-player-section">
                        <div class="player-container">
                            <div class="video-placeholder" id="videoPlaceholder">
                                <div class="placeholder-content">
                                    <i class="fas fa-play-circle"></i>
                                    <h3>Selecione um curso para começar</h3>
                                    <p>Escolha um curso na lista ao lado para iniciar seus estudos</p>
                                </div>
                            </div>
                            <iframe id="currentVideo" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: none;"></iframe>
                        </div>
                        
                        <div class="video-info">
                            <div class="video-header">
                                <h1 id="videoTitle">Bem-vindo à Biblioteca de Treinamentos</h1>
                                <div class="video-meta" id="videoMeta" style="display: none;">
                                    <div class="meta-item">
                                        <i class="fas fa-clock"></i>
                                        <span id="videoDuration">--:--</span>
                                    </div>
                                    <div class="meta-item">
                                        <i class="fas fa-layer-group"></i>
                                        <span id="videoModule">Módulo</span>
                                    </div>
                                    <div class="meta-item">
                                        <i class="fas fa-star"></i>
                                        <span>9.5</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="progress-section" id="progressSection" style="display: none;">
                                <div class="progress-header">
                                    <span class="progress-label">Progresso do Curso</span>
                                    <span class="progress-percentage" id="progressPercentage">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                            </div>
                            
                            <div class="completion-section" id="completionSection" style="display: none;">
                                <label class="completion-checkbox">
                                    <input type="checkbox" id="completedCheckbox">
                                    <span class="checkmark"></span>
                                    <span class="checkbox-label">Marcar como concluído</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Transcrição -->
                    <div class="transcription-section" id="transcriptionSection" style="display: none;">
                        <div class="section-header">
                            <h3><i class="fas fa-file-alt"></i> Transcrição</h3>
                            <button class="copy-btn" onclick="copiarTranscricao()">
                                <i class="fas fa-copy"></i>
                                Copiar
                            </button>
                        </div>
                        <div class="transcription-content" id="transcriptionContent">
                            <!-- Conteúdo da transcrição -->
                        </div>
                    </div>
                    
                    <!-- Navegação de Vídeos -->
                    <div class="video-navigation" id="videoNavigation" style="display: none;">
                        <button class="nav-btn prev" id="prevVideoBtn" onclick="navegarVideo('anterior')">
                            <i class="fas fa-chevron-left"></i>
                            Vídeo Anterior
                        </button>
                        <button class="nav-btn next" id="nextVideoBtn" onclick="navegarVideo('proximo')">
                            Próximo Vídeo
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </main>
            </div>
        </div>

        <!-- Área de Admin (com controle de implantação integrado) -->
        <div id="adminArea" class="admin-area" style="display:none;">
            <!-- Conteúdo do admin será mantido similar -->
            <div class="admin-header">
                <button class="breadcrumb-btn" onclick="voltarInicio()">
                    <i class="fas fa-arrow-left"></i>
                    Voltar ao Início
                </button>
                <h1>Painel Administrativo</h1>
            </div>
            
            <!-- Admin Navigation -->
            <nav class="admin-nav">
                <button class="admin-nav-btn active" onclick="mostrarSecaoAdmin('videos')">
                    <i class="fas fa-video"></i>
                    Gerenciar Vídeos
                </button>
                <button class="admin-nav-btn" onclick="mostrarSecaoAdmin('implantacoes')">
                    <i class="fas fa-building"></i>
                    Implantações
                </button>
                <button class="admin-nav-btn" onclick="mostrarSecaoAdmin('BI')">
                    <i class="fas fa-chart-pie"></i>
                    Business Intelligence
                </button>
                <button class="admin-nav-btn" onclick="mostrarSecaoAdmin('scrum')">
                    <i class="fas fa-tasks"></i>
                    Kanban
                </button>
            </nav>
            
            <!-- Admin Content será preenchido dinamicamente -->
            <div class="admin-content">
                <!-- Conteúdo será gerado pelo JavaScript -->
            </div>
        </div>
    </div>

    <!-- Adicione esta estrutura no seu HTML -->
<section id="json-editor">
  <h2>Editor de Dados</h2>
  <textarea id="json-data" rows="15" cols="50"></textarea>
  <button id="update-btn">Atualizar Dados</button>
  <p id="message"></p>
</section>

<script>
  // Configurações
  const BIN_ID = "SEU_BIN_ID_AQUI"; // Substitua pelo seu Bin ID
  const ACCESS_KEY = "SUA_ACCESS_KEY_AQUI"; // Substitua pela sua chave

  // Elementos DOM
  const jsonTextarea = document.getElementById('json-data');
  const updateBtn = document.getElementById('update-btn');
  const messageEl = document.getElementById('message');

  // Função para carregar dados do JSONBin
  async function loadData() {
    try {
      const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: {
          'X-Master-Key': ACCESS_KEY
        }
      });

      if (!response.ok) throw new Error('Erro ao carregar dados');
      
      const data = await response.json();
      return data.record;
    } catch (error) {
      messageEl.textContent = `Erro: ${error.message}`;
      return null;
    }
  }

  // Função para salvar dados no JSONBin
  async function saveData(newData) {
    try {
      const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          'X-Master-Key': ACCESS_KEY
        },
        body: JSON.stringify(newData)
      });

      if (!response.ok) throw new Error('Erro ao salvar dados');
      
      const result = await response.json();
      return result;
    } catch (error) {
      messageEl.textContent = `Erro: ${error.message}`;
      return null;
    }
  }

  // Interface: Carregar e exibir dados ao iniciar
  window.addEventListener('DOMContentLoaded', async () => {
    const data = await loadData();
    if (data) {
      jsonTextarea.value = JSON.stringify(data, null, 2);
      messageEl.textContent = "Dados carregados com sucesso!";
    }
  });

  // Atualizar dados quando clicar no botão
  updateBtn.addEventListener('click', async () => {
    try {
      const newData = JSON.parse(jsonTextarea.value);
      const result = await saveData(newData);
      
      if (result) {
        messageEl.textContent = "Dados atualizados com sucesso!";
        messageEl.style.color = "green";
        
        // Atualize sua aplicação com os novos dados
        console.log("Novos dados:", newData);
      }
    } catch (error) {
      messageEl.textContent = "JSON inválido! Verifique a formatação.";
      messageEl.style.color = "red";
    }
  });
</script>

    <!-- Footer -->
    <footer class="alura-footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img id="logoFooter" src="images-removebg-preview.png" alt="Logo" />
                <span></span>
            </div>
            <p>&copy; 2025 - Todos os direitos reservados</p>
        </div>
    </footer>

    <!-- Modal para Adicionar/Editar Vídeo -->
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Adicionar Novo Vídeo</h3>
                <button class="close-modal" onclick="fecharModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="videoId">ID do Vídeo (YouTube)</label>
                    <input type="text" id="videoId" placeholder="Ex: JiEhrPTtHI0">
                </div>
                <div class="form-group">
                    <label for="videoTitulo">Título do Vídeo</label>
                    <input type="text" id="videoTitulo" placeholder="Digite o título do vídeo">
                </div>
                <div class="form-group">
                    <label for="videoDuracao">Duração (opcional)</label>
                    <input type="text" id="videoDuracao" placeholder="Ex: 5:23">
                </div>
                <div class="form-group">
                    <label for="videoModulo">Módulo/Categoria</label>
                    <input type="text" id="videoModulo" placeholder="Ex: Vendas">
                </div>
                <div class="form-group" id="dominioGroup" style="display: none;">
                    <label for="videoDominio">Domínio</label>
                    <input type="text" id="videoDominio" placeholder="Ex: upbusiness">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="fecharModal()">Cancelar</button>
                <button class="btn-primary" id="modalConfirmBtn" onclick="confirmarVideo()">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar/Editar Empresa -->
    <div id="empresaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitleEmpresa">Adicionar Nova Empresa</h3>
                <button class="close-modal" onclick="fecharModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="nomeEmpresa">Nome da Empresa</label>
                    <input type="text" id="nomeEmpresa" placeholder="Digite o nome da empresa">
                </div>
                <div class="form-group">
                    <label for="dominioEmpresa">Domínio</label>
                    <input type="text" id="dominioEmpresa" placeholder="ex: upbusiness">
                </div>
                <div class="form-group">
                    <label for="dataInicio">Data de Início</label>
                    <input type="date" id="dataInicio">
                </div>
                <div class="form-group">
                    <label for="dataPrevisao">Previsão de Conclusão</label>
                    <input type="date" id="dataPrevisao">
                </div>
                <div class="form-group">
                    <label for="responsavel">Responsável</label>
                    <input type="text" id="responsavel" placeholder="Nome do responsável">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="fecharModal()">Cancelar</button>
                <button class="btn-primary" onclick="salvarEmpresa()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar/Editar Tarefa Kanban -->
    <div id="kanbanModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitleKanban">Adicionar Nova Tarefa</h3>
                <button class="close-modal" onclick="fecharModalKanban()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="tarefaTitulo">Título da Tarefa</label>
                    <input type="text" id="tarefaTitulo" placeholder="Digite o título da tarefa">
                </div>
                <div class="form-group">
                    <label for="tarefaDescricao">Descrição</label>
                    <textarea id="tarefaDescricao" placeholder="Descreva a tarefa..." rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="tarefaPrioridade">Prioridade</label>
                    <select id="tarefaPrioridade">
                        <option value="low">Baixa</option>
                        <option value="medium" selected>Média</option>
                        <option value="high">Alta</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tarefaResponsavel">Responsável</label>
                    <input type="text" id="tarefaResponsavel" placeholder="Nome do responsável">
                </div>
                <div class="form-group">
                    <label for="tarefaEstimativa">Estimativa</label>
                    <input type="text" id="tarefaEstimativa" placeholder="ex: 8h, 2d, 1w">
                </div>
                <div class="form-group">
                    <label for="tarefaEstagio">Estágio Inicial</label>
                    <select id="tarefaEstagio">
                        <option value="backlog" selected>Backlog</option>
                        <option value="analysis">Análise</option>
                        <option value="development">Desenvolvimento</option>
                        <option value="testing">Testes</option>
                        <option value="deploy">Deploy</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tarefaProgresso">Progresso (%)</label>
                    <input type="number" id="tarefaProgresso" min="0" max="100" value="0" placeholder="0">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="fecharModalKanban()">Cancelar</button>
                <button class="btn-primary" id="modalConfirmBtnKanban" onclick="salvarTarefaKanban()">Adicionar Tarefa</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="biblioteca.js"></script>
</body>
</html>
